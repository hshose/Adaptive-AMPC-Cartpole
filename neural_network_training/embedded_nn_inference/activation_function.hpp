#ifndef ACTIVATION_FUNCTION_HPP
#define ACTIVATION_FUNCTION_HPP


#   if defined __arm__
#       define ram_section modm_section(".data_sram1")
#       include <modm/platform.hpp>
#   else
#       define ram_section
#   endif

#include <vector>
#include <array>
   
namespace embedded_nn_inference{

using namespace std;


class TANH {
    private:
        ram_section constexpr static float step_size = 0.01f;
        ram_section constexpr static float min_value = -5.0f;
        ram_section constexpr static int tanh_num_elem = 1000;
        ram_section constexpr static std::array<float, tanh_num_elem> tanh_lookup = {-0.9999092042625951,-0.9999073701519814,-0.9999054989933424,-0.9999035900383996,-0.9999016425237643,-0.9998996556706324,-0.9998976286844731,-0.9998955607547113,-0.9998934510544042,-0.9998912987399108,-0.9998891029505543,-0.9998868628082794,-0.9998845774173003,-0.9998822458637435,-0.9998798672152829,-0.9998774405207668,-0.9998749648098384,-0.9998724390925483,-0.9998698623589587,-0.9998672335787402,-0.9998645517007604,-0.9998618156526641,-0.9998590243404445,-0.9998561766480074,-0.9998532714367244,-0.9998503075449787,-0.9998472837877015,-0.9998441989558979,-0.9998410518161654,-0.9998378411102006,-0.9998345655542966,-0.9998312238388316,-0.9998278146277448,-0.999824336558004,-0.9998207882390606,-0.9998171682522956,-0.9998134751504524,-0.9998097074570593,-0.9998058636658408,-0.9998019422401158,-0.9997979416121844,-0.9997938601827029,-0.9997896963200444,-0.9997854483596491,-0.999781114603359,-0.9997766933187409,-0.9997721827383951,-0.9997675810592502,-0.9997628864418442,-0.9997580970095901,-0.9997532108480275,-0.9997482260040597,-0.9997431404851737,-0.9997379522586461,-0.9997326592507327,-0.999727259345841,-0.9997217503856869,-0.9997161301684341,-0.9997103964478165,-0.9997045469322422,-0.9996985792838805,-0.9996924911177295,-0.9996862800006663,-0.999679943450476,-0.9996734789348639,-0.9996668838704453,-0.9996601556217168,-0.9996532915000059,-0.9996462887623999,-0.9996391446106534,-0.9996318561900731,-0.9996244205883817,-0.9996168348345574,-0.9996090958976507,-0.9996012006855778,-0.9995931460438896,-0.9995849287545152,-0.9995765455344817,-0.9995679930346069,-0.9995592678381662,-0.9995503664595334,-0.9995412853427935,-0.9995320208603277,-0.9995225693113702,-0.9995129269205365,-0.9995030898363213,-0.9994930541295671,-0.9994828157919013,-0.9994723707341433,-0.9994617147846778,-0.9994508436877974,-0.9994397531020103,-0.9994284385983162,-0.9994168956584453,-0.9994051196730636,-0.9993931059399421,-0.999380849662089,-0.9993683459458442,-0.9993555897989372,-0.9993425761285043,-0.999329299739067,-0.9993157553304705,-0.9993019374957799,-0.9992878407191353,-0.9992734593735638,-0.9992587877187472,-0.9992438198987459,-0.9992285499396772,-0.999212971747347,-0.9991970791048344,-0.9991808656700278,-0.9991643249731132,-0.99914745041401,-0.999130235259758,-0.9991126726418512,-0.9990947555535189,-0.9990764768469518,-0.9990578292304744,-0.9990388052656595,-0.9990193973643865,-0.9989995977858408,-0.9989793986334531,-0.998958791851778,-0.998937769223312,-0.9989163223652454,-0.9988944427261528,-0.9988721215826155,-0.9988493500357786,-0.9988261190078384,-0.9988024192384614,-0.9987782412811311,-0.998753575499424,-0.9987284120632095,-0.9987027409447773,-0.9986765519148859,-0.9986498345387343,-0.9986225781718535,-0.9985947719559166,-0.9985664048144671,-0.9985374654485615,-0.9985079423323265,-0.9984778237084296,-0.9984470975834583,-0.9984157517232097,-0.9983837736478877,-0.9983511506272034,-0.9983178696753822,-0.9982839175460702,-0.9982492807271415,-0.9982139454354036,-0.9981778976111987,-0.9981411229128986,-0.9981036067112925,-0.9980653340838644,-0.9980262898089581,-0.9979864583598287,-0.9979458238985769,-0.9979043702699658,-0.9978620809951161,-0.997818939265078,-0.9977749279342794,-0.9977300295138438,-0.9976842261647807,-0.9976374996910418,-0.9975898315324421,-0.9975412027574452,-0.9974915940558062,-0.997440985731074,-0.9973893576929465,-0.9973366894494791,-0.9972829600991421,-0.9972281483227238,-0.9971722323750787,-0.9971151900767149,-0.9970569988052209,-0.996997635486526,-0.9969370765859934,-0.996875298099342,-0.9968122755433939,-0.9967479839466443,-0.9966823978396512,-0.9966154912452405,-0.9965472376685257,-0.9964776100867343,-0.996406580938843,-0.9963341221150144,-0.9962602049458319,-0.9961848001913324,-0.9961078780298288,-0.9960294080465228,-0.9959493592219002,-0.995867699919909,-0.9957843978759134,-0.9956994201844217,-0.9956127332865825,-0.9955243029574473,-0.9954340942929939,-0.9953420716969065,-0.99524819886711,-0.9951524387820521,-0.9950547536867305,-0.9949551050784606,-0.9948534536923793,-0.9947497594866797,-0.9946439816275738,-0.994536078473978,-0.9944260075619155,-0.9943137255886342,-0.9941991883964316,-0.9940823509561856,-0.9939631673505832,-0.9938415907570455,-0.9937175734303412,-0.9935910666848863,-0.9934620208767228,-0.9933303853851734,-0.9931961085941655,-0.9930591378732213,-0.992919419558107,-0.992776898931137,-0.992631520201128,-0.9924832264829985,-0.9923319597770052,-0.9921776609476163,-0.9920202697020118,-0.9918597245682078,-0.9916959628727987,-0.9915289207183132,-0.9913585329601762,-0.9911847331832744,-0.9910074536781177,-0.9908266254165919,-0.9906421780272986,-0.9904540397704736,-0.9902621375124827,-0.990066396699886,-0.9898667413330675,-0.9896630939394229,-0.9894553755461026,-0.9892435056523028,-0.9890274022010992,-0.9888069815508205,-0.9885821584459533,-0.988352845987577,-0.9881189556033193,-0.9878803970168318,-0.9876370782167777,-0.9873889054253283,-0.9871357830661628,-0.9868776137319676,-0.9866142981514303,-0.9863457351557237,-0.9860718216444758,-0.9857924525512225,-0.9855075208083371,-0.9852169173114361,-0.9849205308832533,-0.9846182482369834,-0.9843099539390887,-0.9839955303715675,-0.9836748576936802,-0.9833478138031324,-0.9830142742967113,-0.9826741124303737,-0.9823271990787846,-0.9819734026943043,-0.9816125892654238,-0.9812446222746463,-0.9808693626558167,-0.9804866687508973,-0.9800963962661914,-0.9796983982280146,-0.9792925249378165,-0.9788786239267537,-0.9784565399097168,-0.9780261147388136,-0.9775871873563142,-0.9771395937470586,-0.9766831668903339,-0.976217736711226,-0.9757431300314515,-0.9752591705196751,-0.9747656786413227,-0.974262471607895,-0.9737493633257944,-0.9732261643446705,-0.9726926818052982,-0.9721487193869992,-0.9715940772546178,-0.9710285520050662,-0.970451936613454,-0.9698640203788144,-0.9692645888694489,-0.9686534238679029,-0.9680303033155948,-0.9673950012571181,-0.9667472877842368,-0.9660869289795985,-0.9654136868601891,-0.9647273193205547,-0.9640275800758169,-0.9633142186045134,-0.9625869800912908,-0.9618456053694837,-0.961089830863614,-0.960319388531845,-0.9595340058084292,-0.9587334055461876,-0.9579173059590634,-0.957085420564793,-0.9562374581277391,-0.9553731226019355,-0.9544921130743921,-0.9535941237087119,-0.9526788436890776,-0.9517459571646616,-0.9507951431945212,-0.9498260756930405,-0.9488384233759847,-0.9478318497072341,-0.9468060128462683,-0.9457605655964739,-0.9446951553543538,-0.9436094240597149,-0.94250300814692,-0.9413755384972874,-0.9402266403927275,-0.9390559334707117,-0.9378630316806652,-0.9366475432418873,-0.935409070603099,-0.9341472104037275,-0.9328615534370349,-0.9315516846152082,-0.9302171829365263,-0.9288576214547277,-0.9274725672507034,-0.926061581406646,-0.9246242189827882,-0.9231600289968692,-0.9216685544064713,-0.9201493320943724,-0.9186018928570671,-0.9170257613966083,-0.9154204563159325,-0.9137854901178277,-0.9121203692077173,-0.9104245939004265,-0.9086976584311126,-0.9069390509705371,-0.9051482536448665,-0.9033247425601896,-0.9014679878319467,-0.8995774536194668,-0.8976525981658167,-0.8956928738431644,-0.8936977272038725,-0.8916665990375278,-0.8895989244341314,-0.8874941328536653,-0.8853516482022624,-0.8831708889152076,-0.880951268046997,-0.8786921933686958,-0.8763930674728228,-0.874053287886007,-0.8716722471896521,-0.8692493331488548,-0.8667839288498186,-0.864275412846011,-0.8617231593133063,-0.8591265382143658,-0.8564849154724973,-0.8537976531552436,-0.8510641096679438,-0.8482836399575129,-0.8454555957266802,-0.8425793256589296,-0.8396541756543753,-0.8366794890768107,-0.8336546070121552,-0.8305788685385284,-0.8274516110081666,-0.8242721703413974,-0.8210398813328772,-0.8177540779702877,-0.814414093765686,-0.8110192620996813,-0.8075689165786143,-0.8040623914048921,-0.8004990217606297,-0.7968781442047266,-0.7931990970835009,-0.7894612209549804,-0.7856638590269437,-0.781806357608774,-0.7778880665771849,-0.773908339855842,-0.7698665359089003,-0.7657620182484388,-0.7615941559557649,-0.7573623242165264,-0.7530659048695518,-0.7487042869693086,-0.7442768673618373,-0.7397830512740043,-0.735222252915869,-0.7305938960959436,-0.7258974148490807,-0.7211322540766999,-0.7162978701990246,-0.7113937318189624,-0.7064193203972352,-0.7013741309383126,-0.6962576726866816,-0.6910694698329304,-0.6858090622290944,-0.6804760061126619,-0.675069874838608,-0.6695902596187705,-0.6640367702678489,-0.658409035955251,-0.6527067059619901,-0.6469294504417663,-0.6410769611853463,-0.6351489523872873,-0.6291451614140355,-0.6230653495723608,-0.6169093028770648,-0.6106768328168442,-0.6043677771171636,-0.5979820004989409,-0.5915193954318162,-0.5849798828807287,-0.5783634130445058,-0.5716699660851169,-0.5648995528462247,-0.5580522155596243,-0.551128028538147,-0.5441270988535677,-0.537049566998035,-0.5298956075275293,-0.5226654296858209,-0.5153592780074099,-0.5079774328978959,-0.500520211190235,-0.49298796667532435,-0.4853810906053717,-0.4777000121684976,-0.46994519893303743,-0.46211715726000974,-0.4542164326822592,-0.4462436102487793,-0.43819931483276753,-0.43008421140197944,-0.42189900525000806,-0.41364444218713475,-0.4053213086894627,-0.3969304320050775,-0.38847268021606113,-0.3799489622552244,-0.3713602278765074,-0.362707467578051,-0.3539917124770461,-0.34521403413552115,-0.3363755443363319,-0.32747739480870525,-0.3185207769027709,-0.30950692121263873,-0.30043709714765376,-0.29131261245159074,-0.28213481266963414,-0.2729050805631329,-0.2636248354722029,-0.254295532626391,-0.24491866240370913,-0.23549574953849814,-0.2260283522786705,-0.21651806149302857,-0.20696649972945255,-0.19737532022490417,-0.18774620586828492,-0.17808086811732993,-0.16838104587081462,-0.15864850429749905,-0.14888503362331745,-0.1390924478784577,-0.12927258360605823,-0.119427298534386,-0.10955847021442984,-0.09966799462495547,-0.08975778474715997,-0.07982976911113143,-0.06988589031642926,-0.05992810352914311,-0.049958374957879796,-0.039978680311163604,-0.029991003238820393,-0.019997333759930503,-0.009999666679999247,0.0,0.009999666679999247,0.01999733375993139,0.029991003238820393,0.039978680311163604,0.049958374957879796,0.059928103529143996,0.06988589031642926,0.07982976911113143,0.08975778474715997,0.09966799462495635,0.10955847021442984,0.119427298534386,0.12927258360605823,0.1390924478784577,0.1488850336233183,0.15864850429749905,0.16838104587081462,0.17808086811732993,0.18774620586828578,0.19737532022490417,0.20696649972945255,0.21651806149302857,0.22602835227867132,0.23549574953849814,0.24491866240370913,0.254295532626391,0.2636248354722037,0.2729050805631329,0.28213481266963414,0.29131261245159074,0.3004370971476546,0.30950692121263873,0.3185207769027709,0.32747739480870525,0.3363755443363327,0.34521403413552115,0.3539917124770461,0.362707467578051,0.3713602278765074,0.3799489622552252,0.38847268021606113,0.3969304320050775,0.4053213086894627,0.4136444421871355,0.42189900525000806,0.43008421140197944,0.43819931483276753,0.44624361024878,0.4542164326822592,0.46211715726000974,0.46994519893303743,0.47770001216849833,0.4853810906053717,0.49298796667532435,0.500520211190235,0.5079774328978964,0.5153592780074099,0.5226654296858209,0.5298956075275293,0.5370495669980356,0.5441270988535677,0.551128028538147,0.5580522155596243,0.5648995528462247,0.5716699660851174,0.5783634130445058,0.5849798828807287,0.5915193954318162,0.5979820004989415,0.6043677771171636,0.6106768328168442,0.6169093028770648,0.6230653495723614,0.6291451614140355,0.6351489523872873,0.6410769611853463,0.6469294504417669,0.6527067059619901,0.658409035955251,0.6640367702678489,0.669590259618771,0.675069874838608,0.6804760061126619,0.6858090622290944,0.6910694698329308,0.6962576726866816,0.7013741309383126,0.7064193203972352,0.7113937318189624,0.7162978701990246,0.7211322540766999,0.7258974148490807,0.7305938960959436,0.7352222529158694,0.7397830512740043,0.7442768673618373,0.7487042869693086,0.7530659048695522,0.7573623242165264,0.7615941559557649,0.7657620182484388,0.7698665359089005,0.7739083398558422,0.7778880665771849,0.781806357608774,0.7856638590269438,0.7894612209549805,0.7931990970835009,0.7968781442047266,0.8004990217606299,0.8040623914048922,0.8075689165786143,0.8110192620996813,0.8144140937656862,0.8177540779702879,0.8210398813328772,0.8242721703413974,0.8274516110081666,0.8305788685385286,0.8336546070121553,0.8366794890768107,0.8396541756543753,0.8425793256589297,0.8454555957266803,0.8482836399575129,0.8510641096679438,0.8537976531552437,0.8564849154724974,0.8591265382143658,0.8617231593133063,0.8642754128460111,0.8667839288498187,0.8692493331488548,0.8716722471896521,0.8740532878860071,0.8763930674728229,0.8786921933686958,0.880951268046997,0.8831708889152076,0.8853516482022625,0.8874941328536653,0.8895989244341314,0.8916665990375278,0.8936977272038726,0.8956928738431645,0.8976525981658167,0.8995774536194668,0.9014679878319468,0.9033247425601896,0.9051482536448665,0.9069390509705371,0.9086976584311126,0.9104245939004266,0.9121203692077173,0.9137854901178277,0.9154204563159325,0.9170257613966084,0.9186018928570671,0.9201493320943724,0.9216685544064714,0.9231600289968693,0.9246242189827882,0.926061581406646,0.9274725672507034,0.9288576214547277,0.9302171829365263,0.9315516846152082,0.9328615534370349,0.9341472104037276,0.9354090706030991,0.9366475432418873,0.9378630316806652,0.9390559334707118,0.9402266403927276,0.9413755384972874,0.94250300814692,0.9436094240597149,0.9446951553543538,0.9457605655964739,0.9468060128462683,0.9478318497072342,0.9488384233759847,0.9498260756930405,0.9507951431945212,0.9517459571646617,0.9526788436890776,0.9535941237087119,0.9544921130743921,0.9553731226019356,0.9562374581277391,0.957085420564793,0.9579173059590634,0.9587334055461876,0.9595340058084293,0.9603193885318451,0.961089830863614,0.9618456053694837,0.9625869800912908,0.9633142186045135,0.9640275800758169,0.9647273193205547,0.9654136868601892,0.9660869289795985,0.9667472877842368,0.9673950012571181,0.9680303033155949,0.9686534238679029,0.9692645888694489,0.9698640203788144,0.970451936613454,0.9710285520050662,0.9715940772546178,0.9721487193869992,0.9726926818052983,0.9732261643446705,0.9737493633257944,0.974262471607895,0.9747656786413226,0.9752591705196751,0.9757431300314515,0.976217736711226,0.9766831668903339,0.9771395937470586,0.9775871873563143,0.9780261147388136,0.9784565399097168,0.9788786239267538,0.9792925249378165,0.9796983982280146,0.9800963962661914,0.9804866687508973,0.9808693626558167,0.9812446222746463,0.9816125892654238,0.9819734026943044,0.9823271990787846,0.9826741124303737,0.9830142742967113,0.9833478138031325,0.9836748576936802,0.9839955303715675,0.9843099539390887,0.9846182482369833,0.9849205308832533,0.9852169173114361,0.9855075208083371,0.9857924525512225,0.9860718216444758,0.9863457351557237,0.9866142981514303,0.9868776137319676,0.9871357830661628,0.9873889054253283,0.9876370782167777,0.9878803970168318,0.9881189556033193,0.988352845987577,0.9885821584459533,0.9888069815508205,0.9890274022010992,0.9892435056523028,0.9894553755461026,0.9896630939394229,0.9898667413330675,0.9900663966998862,0.9902621375124827,0.9904540397704736,0.9906421780272986,0.9908266254165919,0.9910074536781177,0.9911847331832744,0.9913585329601762,0.9915289207183132,0.9916959628727987,0.9918597245682078,0.9920202697020118,0.9921776609476163,0.9923319597770052,0.9924832264829985,0.992631520201128,0.992776898931137,0.992919419558107,0.9930591378732213,0.9931961085941655,0.9933303853851734,0.9934620208767228,0.9935910666848863,0.9937175734303412,0.9938415907570455,0.9939631673505832,0.9940823509561856,0.9941991883964316,0.9943137255886342,0.9944260075619155,0.994536078473978,0.9946439816275738,0.9947497594866797,0.9948534536923793,0.9949551050784606,0.9950547536867305,0.9951524387820521,0.99524819886711,0.9953420716969065,0.9954340942929939,0.9955243029574473,0.9956127332865825,0.9956994201844217,0.9957843978759134,0.995867699919909,0.9959493592219002,0.9960294080465228,0.9961078780298289,0.9961848001913324,0.9962602049458319,0.9963341221150144,0.996406580938843,0.9964776100867343,0.9965472376685257,0.9966154912452405,0.9966823978396512,0.9967479839466443,0.9968122755433939,0.996875298099342,0.9969370765859934,0.996997635486526,0.9970569988052209,0.9971151900767149,0.9971722323750787,0.9972281483227238,0.9972829600991421,0.9973366894494791,0.9973893576929465,0.997440985731074,0.9974915940558062,0.9975412027574452,0.9975898315324421,0.9976374996910418,0.9976842261647807,0.9977300295138438,0.9977749279342794,0.997818939265078,0.9978620809951161,0.9979043702699658,0.9979458238985769,0.9979864583598287,0.9980262898089581,0.9980653340838644,0.9981036067112925,0.9981411229128986,0.9981778976111987,0.9982139454354036,0.9982492807271415,0.9982839175460702,0.9983178696753822,0.9983511506272034,0.9983837736478877,0.9984157517232097,0.9984470975834583,0.9984778237084296,0.9985079423323265,0.9985374654485615,0.9985664048144671,0.9985947719559166,0.9986225781718535,0.9986498345387343,0.9986765519148859,0.9987027409447773,0.9987284120632095,0.998753575499424,0.9987782412811311,0.9988024192384614,0.9988261190078384,0.9988493500357786,0.9988721215826155,0.9988944427261528,0.9989163223652454,0.998937769223312,0.998958791851778,0.9989793986334531,0.9989995977858408,0.9990193973643865,0.9990388052656595,0.9990578292304744,0.9990764768469518,0.9990947555535189,0.9991126726418512,0.999130235259758,0.99914745041401,0.9991643249731132,0.9991808656700278,0.9991970791048344,0.999212971747347,0.9992285499396772,0.9992438198987459,0.9992587877187472,0.9992734593735638,0.9992878407191353,0.9993019374957799,0.9993157553304705,0.999329299739067,0.9993425761285043,0.9993555897989372,0.9993683459458442,0.999380849662089,0.9993931059399421,0.9994051196730636,0.9994168956584453,0.9994284385983162,0.9994397531020103,0.9994508436877974,0.9994617147846778,0.9994723707341433,0.9994828157919013,0.9994930541295671,0.9995030898363213,0.9995129269205365,0.9995225693113702,0.9995320208603277,0.9995412853427935,0.9995503664595334,0.9995592678381662,0.9995679930346069,0.9995765455344817,0.9995849287545152,0.9995931460438896,0.9996012006855778,0.9996090958976507,0.9996168348345574,0.9996244205883817,0.9996318561900731,0.9996391446106534,0.9996462887623999,0.9996532915000059,0.9996601556217168,0.9996668838704453,0.9996734789348639,0.999679943450476,0.9996862800006663,0.9996924911177295,0.9996985792838805,0.9997045469322422,0.9997103964478165,0.9997161301684341,0.9997217503856869,0.999727259345841,0.9997326592507327,0.9997379522586461,0.9997431404851737,0.9997482260040597,0.9997532108480275,0.9997580970095901,0.9997628864418442,0.9997675810592502,0.9997721827383951,0.9997766933187409,0.999781114603359,0.9997854483596491,0.9997896963200444,0.9997938601827029,0.9997979416121844,0.9998019422401158,0.9998058636658408,0.9998097074570593,0.9998134751504524,0.9998171682522956,0.9998207882390606,0.999824336558004,0.9998278146277448,0.9998312238388316,0.9998345655542966,0.9998378411102006,0.9998410518161654,0.9998441989558979,0.9998472837877015,0.9998503075449787,0.9998532714367244,0.9998561766480074,0.9998590243404445,0.9998618156526641,0.9998645517007604,0.9998672335787402,0.9998698623589587,0.9998724390925483,0.9998749648098384,0.9998774405207668,0.9998798672152829,0.9998822458637435,0.9998845774173003,0.9998868628082794,0.9998891029505543,0.9998912987399108,0.9998934510544042,0.9998955607547113,0.9998976286844731,0.9998996556706324,0.9999016425237643,0.9999035900383996,0.9999054989933424,0.9999073701519814,};
    
    public:
        TANH() {}
        float call(float a);
};

class LINEAR {
    public:
        LINEAR() {}
        float call(float a);
};


} // namespace embedded_nn_inference
#endif // ACTIVATION_FUNCTION_HPP